<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>盘点</title>
	<!-- 预加载页面 -->
	
	<link rel="stylesheet" href="css/iconfont.css">
	<link rel="stylesheet" href="css/dialog.css"> 
	 <link rel="stylesheet" href="css/bootstrap.css"> 
	<link href="css/select2.css" rel="stylesheet" /> 
	<link rel="stylesheet" href="css/lCalendar.css">   
	<link rel="stylesheet" href="css/index.css"> 
	<link rel="stylesheet" href="css/swiper.min.css">

	<script src="js/jquery.min.js"></script>
	<script src="js/cookie.js"></script>
	<script src="js/dialog.js"></script>
	<script src="js/lCalendar.js"></script> 
	<script src="js/hotcss.js"></script>
	<script src="js/doT.js"></script>
	<script src="js/chart.js"></script> 
	<script src="js/fancySelect.js"></script> 
	<script src="js/select2.js"></script>
	<script src="js/main.js"></script> 
	<script src="js/swiper.min.js"></script>
	<script src="js/exif.js"></script>



	<script>
      // 给客户端传
	if (window.JsCallback) {
		var res = window.JsCallback.onGetLoginJSON();
		if (!res) {
			judgmentUrl(null, "login.html"); 
		}
		if (res && JSON.parse(res).hasOwnProperty("token")) {
			loginByEmail(JSON.parse(res));
		} 
	} else {
		setupWebViewJavascriptBridge(function (bridge) {
			bridge.callHandler('onGetLoginJSON', function responseCallback(res) { 
			if (!res) {
				judgmentUrl(null, "login.html"); 
			}
			if (res && JSON.parse(res).hasOwnProperty("token")) {
				$.cookie('userinfo', res, { expires: 30, path: '/', secure: false });
							localStorage.setItem("userinfo",res);
				loginByEmail(JSON.parse(res));
			}
			})
		});
	}

	function loginByEmail(loginData){
		loginData.mail=loginData.username.replaceAll('____','@')
		var registUrl=getURL()+"/mobile/appLoginController.do?loginByEmail";   
		var json={
			"mail":loginData.mail,
			"token":loginData.token
		}  
		sendPost(registUrl,json,callbackB);
		function callbackB(data){     
			if(data.success!="true"){           
				alert(data.msg);   
				judgmentUrl(null, "login.html"); 
				return;
			}else{
				// 存cookie
				var  user = data.data[0].user;
				var departs = data.data[1].depart;
				var func = data.data[2].func;
				
				var user_info = {
					"account":user.account,
					"mail":user.mail,
					"usercode":user.usercode,
					"userid":user.userid,                
					"username":user.username,
				} ;
				// 公司
				var departList=[];
				$.each(departs,function(){
					var lis={
						"departname":this.departname,
						"shortname":this.shortname,
						"departcode":this.departcode,
						"usabledate":this.usabledate,
						"creatorid":this.creatorid,
						"departid":this.departid,
					}
					departList.push(lis);
				}) 
				departList= JSON.stringify(departList); 
				user_info= JSON.stringify(user_info);  
				$.cookie('userinfo', user_info, { expires: 30, path: '/', secure: false });
				$.cookie('departList', departList, { expires: 30, path: '/', secure: false });
				localStorage.setItem("userinfo",user_info);
				localStorage.setItem("departList",departList);
				// 给客户端传数据
			if (window.JsCallback) {
					window.JsCallback.onHideProgress()
					self.location='unit.html';
				}else{
					setupWebViewJavascriptBridge(function (bridge) {
						bridge.callHandler('onHideProgress') 
						self.location='unit.html';
					})
				}
				// 先跳转
			　  
			}
		}
	}

	

	</script>
	<style>
		.mytabs {
			display: none;
		}

		.mytabs.active {
			display: block;
		}
		.scrollCon2{display: none;}
		.swiper-container {
      width: 100%;
      height: 100%;
	}
    .swiper-slide {
      text-align: center;
      font-size: 18px;
      background: #fff;

      /* Center slide text vertically */
      display: -webkit-box;
      display: -ms-flexbox;
      display: -webkit-flex;
      display: flex;
      -webkit-box-pack: center;
      -ms-flex-pack: center;
      -webkit-justify-content: center;
      justify-content: center;
      -webkit-box-align: center;
      -ms-flex-align: center;
      -webkit-align-items: center;
      align-items: center;
    }
	</style>
</head>

<body>
	<nav>
		<a class="back centery linkViewDisplay" id = "indexGoBack" onclick="indexGoBack()">返回</a> 
		<p class="navCon">应用</p>
	</nav>
	<div class="scancontent" style="height: 100%; overflow: auto">
		<div class="mytabs tab1 active">
				<div class="userTop clearfix">
						<div class="userImg">
							<i class="appNav iconfont"></i>
						</div>
						<div class="userInfo">
							<p class="UserName"></p>
							<p class="DepartName"></p>
						</div>
					</div>
			<ul class="linkView clearfix">
				<li>
					<div class="con">
						<!--  -->
						<a href="javascript:;" class="outLine">
							<i class="appNav iconfont icon-icon-"></i>
							<p>资产盘点</p>
						</a>
					</div>
				</li>
				<li>
					<div class="con">
						<a href="JavaScript:;" onclick="dbsqAbtn()">
							<i class="appNav iconfont icon-navicon-dbd"></i>
							<p>调拨申请</p>
						</a>
					</div>
				</li>
				<li>
					<div class="con">

						<a href="JavaScript:;" onclick="bfsqAbtn()">
							<i class="appNav iconfont icon-empty"></i>
							<p>报废申请</p>
						</a>
					</div>
				</li>
			</ul>
			<div class="charts charleft" > 
				<canvas id="myChart"></canvas>
			</div> 
			<div class="charts charleft"> 
					<canvas id="chart-0"></canvas>
			</div> 
			<div class="charts"> 
					<!-- <canvas id="chart-1"></canvas> -->
					<div class="cardList" id="tab2">
						<div class="borderDbDetailBox">
							<ul id="dblist" onclick="checkNetwork('property/localSearch.html?value=0')">
								<li class="clearfix">  
									<span class="listInfo">
										<b>待办类型 ：<i>正在盘点</i></b>
										<b>待办数量 ：<i id="zzpdCount">0</i></b>
									</span> 
								</li>
							</ul>
							<ul id="dblist" onclick="checkNetwork('property/downloadList.html')">
								<li class="clearfix">  
									<span class="listInfo">
										<b>待办类型 ：<i>未盘计划</i></b>
										<b>待办数量 ：<i id="wpjhCount">0</i></b>
									</span> 
								</li>
							</ul>
							<!-- <ul id="dblist" onclick="javascript:window.location.href='transfer/transferList.html?value=0'">
								<li class="clearfix">  
									<span class="listInfo">
										<b>待办类型 ：<i>调拨上报</i></b>
										<b>待办数量 ：<i id="dbsbCount">0</i></b>
									</span> 
								</li>
							</ul> -->
							<ul id="dblist" onclick="checkNetwork('transfer/shenpi.html')">
								<li class="clearfix">  
									<span class="listInfo">
										<b>待办类型 ：<i>调拨审批</i></b>
										<b>待办数量 ：<i id="dbspCount">0</i></b>
									</span> 
								</li>
							</ul>
							<ul id="dblist" onclick="checkNetwork('transfer/transferOUT.html')">
								<li class="clearfix">  
									<span class="listInfo">
										<b>待办类型 ：<i>调出确认</i></b>
										<b>待办数量 ：<i id="dcqrCount">0</i></b>
									</span> 
								</li>
							</ul>
							<ul id="dblist" onclick="checkNetwork('transfer/transferIN.html')">
								<li class="clearfix">  
									<span class="listInfo">
										<b>待办类型 ：<i>调入确认</i></b>
										<b>待办数量 ：<i id="drqrCount">0</i></b>
									</span> 
								</li>
							</ul>
							<ul id="dblist" onclick="checkNetwork('destory/shenpiList.html')">
								<li class="clearfix">  
									<span class="listInfo">
										<b>待办类型 ：<i>报废审批</i></b>
										<b>待办数量 ：<i id="bfspCount">0</i></b>
									</span> 
								</li>
							</ul>
						</div>
					</div>
			</div>
		</div>
		<div class="mytabs tab2">
				<div class="userTop clearfix">
						<div class="userImg">
							<i class="appNav iconfont"></i>
						</div>
						<div class="userInfo">
							<p class="UserName"></p>
							<p class="DepartName"></p>
						</div>
					</div>
			<ul class="linkView2 clearfix">
				<li>
					<div class="con">

						<a href="JavaScript:;" class="" onclick="zcpdLinkViewShow()">
							<i class="appNav iconfont icon-icon-"></i>
							<p>资产盘点</p>

						</a>
					</div>
				</li> 
				<!-- <li>
					<div>
						<div class="con">
							<a href="JavaScript:;" onclick="pdcxAbtn()">
								<i class="appNav iconfont icon-diaobo"></i>
								<p>盘点查询</p>
							</a>
						</div>

					</div>
				</li>
				<li>
					<div>
						<div class="con">

							<a href="JavaScript:;" onclick="sjxzAbtn()">
								<i class="appNav iconfont icon-msnui-cloud-download"></i>
								<p>数据下载</p>
							</a>
						</div>

					</div>
				</li>
				<li>
					<div class="con">
						<a data-prefetch="true" href="JavaScript:;" onclick="bdxzcxAbtn()">
							<i class="appNav iconfont icon-chaxuntiaojian"></i>
							<p>本地下载查询</p>
						</a>
					</div>
				</li>
				<li>
					<div class="con">

						<a href="JavaScript:;" onclick="sjscAbtn()">
							<i class="appNav iconfont icon-shangchuan"></i>
							<p>数据上传</p>
						</a>
					</div>
				</li> -->
				<li>
					<div class="con">

						<a href="JavaScript:;" onclick="bfglLinkViewShow()">
							<i class="appNav iconfont icon-cloud-scrap"></i>
							<p>报废管理</p>
						</a>
					</div>
				</li>
				<!-- <li>
					<div class="con">

						<a href="JavaScript:;" onclick="bfspAbtn()">
							<i class="appNav iconfont icon-shenpi"></i>
							<p>报废审批</p>
						</a>
					</div>
				</li>
				 <li>
					<div class="con">

						<a href="JavaScript:;" onclick="bfcxAbtn()">
							<i class="appNav iconfont icon-chaxuntiaojian"></i>
							<p>报废查询</p>
						</a>
					</div>
				</li>  -->
				<li>
					<div>
						<div class="con">
							<a href="JavaScript:;" onclick="dbglLinkViewShow()">
								<i class="appNav iconfont icon-navicon-dbd"></i>
								<p>调拨管理</p>
							</a>
						</div>

					</div>
				</li>
				<!-- <li>
					<div>
						<div class="con">
							<a href="JavaScript:;" onclick="dbczAbtn()">
								<i class="appNav iconfont icon-caozuo1"></i>
								<p>调拨操作</p>
							</a>
						</div>

					</div>
				</li>
				<li>
					<div>
						<div class="con">
							<a href="JavaScript:;" onclick="dbspAbtn()">
								<i class="appNav iconfont icon-navicon-dbsqdsp"></i>
								<p>调拨审批</p>
							</a>
						</div> 
					</div>
				</li> 
				<li>
					<div class="con">
						<a href="JavaScript:;" onclick="dcqrAbtn()">
							<i class="appNav iconfont icon-tiaochu"></i>
							<p>调出确认</p>
						</a>
					</div>
				</li> 
				<li>
					<div class="con">
						<a href="JavaScript:;" onclick="drqrAbtn()">
							<i class="appNav iconfont icon-tiaoru"></i>
							<p>调入确认</p>
						</a>
					</div>
				</li>
				<li>
					<div>
						<div class="con">
							<a href="JavaScript:;" onclick="dbcxAbtn()">
								<i class="appNav iconfont icon-diaobo"></i>
								<p>调拨查询</p>
							</a>
						</div>

					</div>
				</li>  -->
				<li>
					<div class="con">

						<a href="JavaScript:;" onclick="tjcxLinkViewShow()">
							<i class="appNav iconfont icon-chaxuntiaojian"></i>
							<p>统计查询</p>
						</a>
					</div>
				</li> 
				<li>
					<div class="con">

						<a href="JavaScript:;" class="" onclick="jyzglLinkViewShow()">
							<i class="appNav iconfont icon-caozuo1"></i>
							<p>加油站管理</p>
						</a>
					</div>
				</li> 
				<!-- <li>
					<div class="con">

						<a href="JavaScript:;" onclick="tzcxAbtn()">
							<i class="appNav iconfont icon-chaxuntiaojian"></i>
							<p>台账查询</p>
						</a>
					</div>
				</li> 
				<li>
						<div class="con">
	
							<a href="JavaScript:;" onclick="hzcxAbtn()">
								<i class="appNav iconfont icon-chaxuntiaojian"></i>
								<p>汇总查询</p>
							</a>
						</div>
					</li> 
				<li>
					<div class="con">

							<a href="JavaScript:;" id = "pyEntry">
									<i class="appNav iconfont icon-chaxuntiaojian"></i>
							<p>盘盈录入</p>
						</a>
					</div>
				</li>  -->
			</ul>


			<ul class="linkView clearfix linkViewDisplay" id = "zcpdLinkView">
				<li>
					<div class="con">

						<a href="JavaScript:;" class="outLine">
							<i class="appNav iconfont icon-icon-"></i>
							<p>资产盘点</p>

						</a>
					</div>
				</li> 
				<li>
					<div>
						<div class="con">
							<a href="JavaScript:;" onclick="pdcxAbtn()">
								<i class="appNav iconfont icon-diaobo"></i>
								<p>盘点查询</p>
							</a>
						</div>

					</div>
				</li>
				<li>
					<div>
						<div class="con">

							<a href="JavaScript:;" onclick="sjxzAbtn()">
								<i class="appNav iconfont icon-msnui-cloud-download"></i>
								<p>数据下载</p>
							</a>
						</div>

					</div>
				</li>
				<li>
					<div class="con">
						<a data-prefetch="true" href="JavaScript:;" onclick="bdxzcxAbtn()">
							<i class="appNav iconfont icon-chaxuntiaojian"></i>
							<p>本地下载查询</p>
						</a>
					</div>
				</li>
				<li>
					<div class="con">

						<a href="JavaScript:;" onclick="sjscAbtn()">
							<i class="appNav iconfont icon-shangchuan"></i>
							<p>数据上传</p>
						</a>
					</div>
				</li>
				<li>
					<div class="con">

							<a href="JavaScript:;" id = "pyEntry">
									<i class="appNav iconfont icon-chaxuntiaojian"></i>
							<p>盘盈录入</p>
						</a>
					</div>
				</li> 
			</ul>

			<ul class="linkView clearfix linkViewDisplay" id = "bfglLinkView">
				<li>
					<div class="con">

						<a href="JavaScript:;" onclick="bfsqAbtn()">
							<i class="appNav iconfont icon-cloud-scrap"></i>
							<p>报废申请</p>
						</a>
					</div>
				</li>
				<li>
					<div class="con">

						<a href="JavaScript:;" onclick="bfspAbtn()">
							<i class="appNav iconfont icon-shenpi"></i>
							<p>报废审批</p>
						</a>
					</div>
				</li>
				 <li>
					<div class="con">

						<a href="JavaScript:;" onclick="bfcxAbtn()">
							<i class="appNav iconfont icon-chaxuntiaojian"></i>
							<p>报废查询</p>
						</a>
					</div>
				</li> 
			</ul>

			<ul class="linkView clearfix linkViewDisplay" id = "dbglLinkView">
				<li>
					<div>
						<div class="con">
							<a href="JavaScript:;" onclick="dbsqAbtn()">
								<i class="appNav iconfont icon-navicon-dbd"></i>
								<p>调拨申请</p>
							</a>
						</div>

					</div>
				</li>
				<li>
					<div>
						<div class="con">
							<a href="JavaScript:;" onclick="dbczAbtn()">
								<i class="appNav iconfont icon-caozuo1"></i>
								<p>调拨操作</p>
							</a>
						</div>

					</div>
				</li>
				<li>
					<div>
						<div class="con">
							<a href="JavaScript:;" onclick="dbspAbtn()">
								<i class="appNav iconfont icon-navicon-dbsqdsp"></i>
								<p>调拨审批</p>
							</a>
						</div> 
					</div>
				</li> 
				<li>
					<div class="con">
						<a href="JavaScript:;" onclick="dcqrAbtn()">
							<i class="appNav iconfont icon-tiaochu"></i>
							<p>调出确认</p>
						</a>
					</div>
				</li> 
				<li>
					<div class="con">
						<a href="JavaScript:;" onclick="drqrAbtn()">
							<i class="appNav iconfont icon-tiaoru"></i>
							<p>调入确认</p>
						</a>
					</div>
				</li>
				<li>
					<div>
						<div class="con">
							<a href="JavaScript:;" onclick="dbcxAbtn()">
								<i class="appNav iconfont icon-diaobo"></i>
								<p>调拨查询</p>
							</a>
						</div>

					</div>
				</li> 
			</ul>

			<ul class="linkView clearfix linkViewDisplay" id = "tjcxLinkView">
				<li>
					<div class="con">

						<a href="JavaScript:;" onclick="zccxAbtn()">
							<i class="appNav iconfont icon-chaxuntiaojian"></i>
							<p>资产查询</p>
						</a>
					</div>
				</li> 
				<li>
					<div class="con">

						<a href="JavaScript:;" onclick="tzcxAbtn()">
							<i class="appNav iconfont icon-chaxuntiaojian"></i>
							<p>台账查询</p>
						</a>
					</div>
				</li> 
				<li>
						<div class="con">
	
							<a href="JavaScript:;" onclick="hzcxAbtn()">
								<i class="appNav iconfont icon-chaxuntiaojian"></i>
								<p>汇总查询</p>
							</a>
						</div>
					</li> 
				
			</ul>

			<ul class="linkView clearfix linkViewDisplay" id = "jyzglLinkView">
				<li>
					<div class="con">

						<a href="JavaScript:;" onclick="zjblrAbtn()">
							<i class="appNav iconfont icon-navicon-dbd"></i>
							<p>周检表录入</p>
						</a>
					</div>
				</li> 
				<li>
					<div class="con">

						<a href="JavaScript:;" onclick="zjbscAbtn()">
							<i class="appNav iconfont icon-shangchuan"></i>
							<p>周检表上传</p>
						</a>
					</div>
				</li> 
			</ul>


		</div>
		<div class="mytabs tab3">
				<div class="userTop clearfix">
						<div class="userImg">
							<i class="appNav iconfont"></i>
						</div>
						<div class="userInfo">
							<p class="UserName"></p>
							<p class="DepartName"></p>
						</div>
					</div>
			<ul class="linkView clearfix">
				<li>
					<div class="con">
						<i class="appNav iconfont icon-setup"></i>
						<!-- <a href="set/server.html"> -->
						<a href="JavaScript:;" onclick="fwqszAbtn()">

							<p>服务器设置</p>
						</a>
					</div>
				</li>
				<li>
					<div>
						<div class="con">
							<i class="appNav iconfont icon-brush"></i>
							<!-- <a href="set/reset.html"> -->
							<a href="JavaScript:;" onclick="xgmmAbtn()">

								<p>修改密码</p>
							</a>
						</div>

					</div>
				</li>
				<li>
					<div>
						<div class="con">
							<i class="appNav iconfont icon-qiehuanzuzhi"></i>
							<!-- <a href="unit.html"> -->
							<a href="JavaScript:;" onclick="qhdwAbtn()">
									<p>切换单位</p>
							</a>
						</div>

					</div>
				</li> 
				<li>
					<div>
						<div class="con">
							<i class="appNav iconfont icon-qiehuan1"></i>
							<!-- <a href="login.html"> -->
							<a href="JavaScript:;" onclick="cxdlAbtn()">

								<p>重新登陆</p>
							</a>
						</div>

					</div>
				</li> 
				<li>
					<div>
						<div class="con delateData">
							<i class="appNav iconfont icon-empty"></i>
							<a href="javascript:;">
								<p>清除数据</p>
							</a>
						</div>

					</div>
				</li> 
				<li>
					<div>
						<div class="con updateDepart">
							<i class="appNav iconfont icon-msnui-cloud-download"></i>
							<a href="javascript:;">
								<p>更新字典</p>
							</a>
						</div>

					</div>
				</li> 
			</ul>
		</div>
	</div>
	<footer class="navFooter" style="z-index: 21;">
		<ul class="clearfixs">
			<li tabS="tab1" class="active">
				<a href="javascript:;">
					<i class="appNav iconfont icon-shouye"></i> 
					<span>首页</span>
				</a>
			</li>
			<li tabS="tab2">
				<a href="javascript:;">
					<i class="appNav iconfont icon-erji-yingyongzhuangtai"></i>
					<span>应用</span>
				</a>
			</li>
			<li tabS="tab3">
				<a href="javascript:;">
					<i class="appNav iconfont icon-wode"></i>
					<span>我的

					</span>
				</a>
			</li>
		</ul>
	</footer>
	<div class="indexBox" id='Hbox1' style="background:#fff;">
		<nav>
			<a class="backOn centery backOnOut" href="javascript:;">返回</a>
			<p class="navCon">资产盘点</p>
		</nav>
		<div class="content scrollCon scrollCon1">
			<form class="formEntry SformEntry"> 
				<p>
					<label for="assetsCode">资产条码:</label>
					<input type="text" placeholder="条形码输入" id="lid" required=""> 
					<i id="search" class="iconfont icon-chaxunxiazai"></i> 
				</p> 
			</form>
			<!--需求：用户对资产信息进行确认、修改和补录-->
			<form method='post' class="formEntry" id="formEntry" enctype="multipart/form-data">
				<input type="hidden" name='id'>
				<input type="hidden" name='departCode'> 
				<input type="hidden" name='barCode'> 
				<input type="hidden" name='nowValue'> 
				<input type="hidden" name='originalValue'> 
				<input type="hidden" name='planName'> 
				<input type="hidden" name='planNumber'> 
				<input type="hidden" name='managerDepartName'> 
				
				<p>
					<label for="managerDepart">盘点单位:</label>
					<input type="text" id="managerDepart" name="managerDepart" disabled>
				</p> 
				<p>
					<label for="assetsCode">资产编码:</label>
					<input type="text"   name="assetsCode" disabled>
				</p>
				<p>
					<label class="editStatus" for="assetsStatus">使用状态:</label>
					 <select name="assetsStatus" value='010101' id="assetsStatus">
						 <option value="010101">生产经营用-科研</option>
						 <option value="010102">生产经营用-其他</option>
						 <option value="0102">非生产经营用</option> 
						 <option value="0201">季节性经营停用</option>
						 <option value="0202">其他原因停用</option>
						 <option value="0203">经营场所备用</option>
						 <option value="0204">闲置</option>
						 <option value="03">租出</option>
						 <option value="04">借出</option> 
					 </select>
				</p> 
				<p>
					<label for="assetsName">资产名称:</label>
					<input type="text" name="assetsName" id="assetsName" disabled>
				</p>
				<p>
					<label for="assetsStandard">规格型号:</label>
					<input type="text" name="assetsStandard" id="assetsStandard">
				</p>
				
				<p>
					<label for="licenceNumber">车牌井号:</label>
					<input type="text" name="licenceNumber" id="licenceNumber">
				</p> 
				<p>
					<label for="storePlaceName">存放地点:</label>
					<!-- <input type="text" name="storePlaceName" id="storePlaceName"> -->
					<select class="select" name="storePlaceName" id="storePlaceName">
						<option value=""></option>
					</select>
				</p>
				<!-- <p>
					<label for="checkResult">盘点状态:</label>
					<select name="checkResult" value="1" id="checkResult">
						<option value="1">存在</option>
						<option value="2">盘亏</option>
						<option value="3">盘盈</option>  
					</select>
				</p> -->
				<p>
					<label for="userPerson" class="editStatus">保管人:</label>
					<input type="text" name="userPerson" id="userPerson">
				</p>
				<p>
					<label class="editStatus" for="realcodeStatus">贴码状态 :</label>
					<select name="realcodeStatus" value="0" id="realcodeStatus">
						<option value="0">相符</option>
						<option value="1">不符</option> 
					</select>
				</p> 
                <p>
                    <label class="editStatus" for="technicalCondition">技术状况</label> 
                    <select name="technicalCondition" value="01" id="technicalCondition">
                        <option value="01">完好</option>
                        <option value="02">带病运行</option>
                        <option value="03">在修</option>
                        <option value="04">待修</option>
                        <option value="05">待报废</option>
                        <option value="06">损毁</option>
                        <option value="07">待处置</option>
                        <option value="08">已处置</option>
                    </select>
                </p>
			</form>
			<input type="hidden" id='keyCode'>

			<div class="zcpdImgBorder">
				<span>图片区</span>
				<div class="swiper-container">
					<div id = "zcpdImgsDiv" class="swiper-wrapper">
					</div>
				</div>
			</div>
			<button class="orange server_save" onclick="deletePDImgs()">删除图片</button>
			

		</div>
		<div id="dialog-confirm" class="center" >
            <p class=""><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>是否进入盘盈?</p>
            <div class="bottom">
                <p id="sure">确定</p>
                <p id="cancle">取消</p>
            </div>    
  		</div>
		<!-- 盘盈 -->
		<div class="content scrollCon scrollCon2">
			<p>盘点计划编码：<span id="PLnum"></span></p>
			<div class="indexBox" id='Hbox2' style="height: 90% !important;">
					<form class="formEntry " id="formEntry2" > 
						<!-- <p>
							<label for="managerDepart">盘点单位:</label>
							<input type="text" name="managerDepartName" id = "pyManagerDepart">
							<input type="hidden" name="departCode" id = "pyDepartCode">

						</p>  -->
						<p>
							盘点单位：
							<select  id="pyDepartCode"></select>
							<input type="hidden" name="managerDepartName" id = "pyManagerDepart">
						</p>
						<p>
							<label for="barCode">资产条码:</label>
							<input type="text" name="barCode">
						</p>
						<p>
							<label for="assetsName" class="editStatus">资产名称 :</label>
							<input type="text" name="assetsName">
						</p>
						<p>
							<label for="assetsStandard">规格型号:</label>
								<input type="text" name="assetsStandard" id="assetsStandard">
						</p>
						<p>
								<label for="lossReason" class="editStatus">盘盈原因:</label>
								<!-- <input type="text" name="lossReason" /> -->
								<select class="select" name="lossReason" id="lossReason">
										<option value=""></option>
								</select>
							</p>
						<p>
							<label for="storePlaceName" class="editStatus">存放地点:</label>
							<!-- <input type="text" name="storePlaceName" id="storePlaceName"> -->
							<select class="select" name="storePlaceName" id="storePlaceName">
								<option value=""></option>
							</select>
						</p>
						<p>
							<label for="userPerson" class="editStatus">保管人:</label>
							<input type="text" name="userPerson" id="userPerson">
						</p>

						<p>
							<label class="editStatus" for="assetsStatus">使用状态:</label>
								<select name="assetsStatus" id="assetsStatus">
									<option selected="selected" value="010102">生产经营用-其他</option>
									<option value="010101">生产经营用-科研</option>
									<option value="0102">非生产经营用</option> 
									<option value="0201">季节性经营停用</option>
									<option value="0202">其他原因停用</option>
									<option value="0203">经营场所备用</option>
									<option value="0204">闲置</option>
									<option value="03">租出</option>
									<option value="04">借出</option> 
								</select>
						</p> 

						<!-- <p>
							<label for="assetsStatus">资产状态:</label>
							 <select name="assetsStatus" value='010101' >
								 <option value="010101">生产经营用-科研</option>
								 <option value="010102">生产经营用-其他</option>
								 <option value="0102">非生产经营用</option> 
								 <option value="0201">季节性经营停用</option>
								 <option value="0202">其他原因停用</option>
								 <option value="0203">经营场所备用</option>
								 <option value="0204">闲置</option>
								 <option value="03">租出</option>
								 <option value="04">借出</option> 
							 </select>
							</p> -->
							<p>
								<label class="editStatus" for="technicalCondition">技术状况</label> 
								<select name="technicalCondition" value="01" id="technicalCondition">
									<option value="01">完好</option>
									<option value="02">带病运行</option>
									<option value="03">在修</option>
									<option value="04">待修</option>
									<option value="05">待报废</option>
									<option value="06">损毁</option>
									<option value="07">待处置</option>
									<option value="08">已处置</option>
								</select>
							</p>
							
							<p>
								<label for="remark">备注:</label>
								<input type="text" name="remark" />
							</p>
							
						</form>
						<div class="zcpdImgBorder">
							<span>图片区</span>
							<div class="swiper-container">
								<div id = "pyImgsDiv" class="swiper-wrapper">
								</div>
							</div>
						</div>
						<button class="orange server_save" onclick="deletePYImgs()">删除图片</button>

					
				</div>
				
		</div> 

		<div class="content scrollCon scrollCon3">
			<div class="indexBox" id='Hbox3' style="height: 90% !important;">
					<form class="formEntry3 " id="formEntry3" > 
						<div style="border: 0.04267rem solid #aaa" id = "yzglPart1">
								<p>分公司 <span class='yzglSpan'>*</span></p>
								<p>
									<select name="fgsmc" id="fgsmc"></select>
									<!-- <input type="" name="fgsmc" id = "fgsmc"> -->
								</p>
		
								<p>油站名称（直接填写简称，如金凤站）<span class='yzglSpan'>*</span></p>
								<p>
									<select name = "yzbm" id="yzbm"></select>
									<!-- <input type="hidden" name="yzbm" id = "yzbm"> -->
								</p>
								<p>周检日期 <span class='yzglSpan'>*</span></p>
								<p>
									<input readonly type="data" id="zjrq" name="zjrq" readonly="readonly"  data-lcalendar="2010-01-11,2025-12-31" /> 
								</p>
		
								<p>
									周检人员(依次填写参与人员,多人用顿号隔开)<span class='yzglSpan'>*</span>
								</p>
								<p>
									<textarea onpropertychange="MaxMe(this)" name="zjry" id="zjry" oninput="MaxMe(this)" style="overflow:hidden"></textarea>
								</p>
		
								<p style="line-height:50px; font-size: 0.55rem">
									以下内容为具体检查要求，对照每条内容进行检查。检查没问题的选择“合格”，有问题的选择“其他情况”，随后输入具体情况。
								</p>
						</div>
						<div id = "yzglPart2">

						</div>

						<div style="border: 0.04267rem solid #aaa; margin-top: 6px;" id = "yzglPart3">
							<p>重点问题图片上传1</p>
							<p>
								<div id = yzglImg1 class="box" onclick=yzglCamera1.click()></div>
								<input type="file" accept="image/*"  id="yzglCamera1" onchange="uploadYzglImg(this, 'yzglImg1')" style="display: none">
							</p>

							<p>重点问题图片上传2</p>
							<p>
								<div id = yzglImg2 class="box" onclick=yzglCamera2.click()></div>
								<input type="file" accept="image/*" capture="camera" id="yzglCamera2" onchange="uploadYzglImg(this, 'yzglImg2')" style="display: none">
							</p>

							<p>重点问题图片上传3</p>
							<p>
								<div id = yzglImg3 class="box" onclick=yzglCamera3.click()></div>
								<input type="file" accept="image/*" capture="camera" id="yzglCamera3" onchange="uploadYzglImg(this, 'yzglImg3')" style="display: none">							</p>
						</div>

						<!-- <div style="border: 0.04267rem solid #aaa; margin-top: 5px;">
								<p style="text-align:center;color:blue;text-decoration:underline">房站检查情况</p>
								
								<p>col1</p>
								<p>
									<select name="" value="" id="col1" onchange="openOtherText(this)">
										<option value="合格">合格</option>
										<option value="其他情况">其他情况</option>
									</select>
									<textarea id="col1textarea" placeholder="请输入其他情况" onpropertychange="MaxMe(this)" oninput="MaxMe(this)" style="overflow:hidden; display: none; margin-top: 3px;"></textarea>
								</p>

								<p>col2</p>
								<p>
									<select name="" value="" id="col2" onchange="openOtherText(this)">
										<option value="合格">合格</option>
										<option value="其他情况">其他情况</option>
									</select>
									<textarea id="col2textarea" placeholder="请输入其他情况" onpropertychange="MaxMe(this)" oninput="MaxMe(this)" style="overflow:hidden; display: none; margin-top: 3px;"></textarea>
								</p>
						</div> -->

					</form>
			</div>
		</div> 

		<bottom class=" bottomFixed bottombgNone" id = "pdBottom">
			<div class="center clearfix">

				<input type="file" accept="image/*" capture="camera" id="zcpdCamera" onchange="changeImg(this)" hidden>
				<button id="zcpdCameraBtn" class="bottomBtn" onclick=zcpdCamera.click()>拍照</button>
				<button id="scanning" class="bottomBtn centerx iconfont icon-icon-"></button>
				<button id="submitBtn" class="bottomBtn iconfont icon-tijiao"></button>
				<!-- <button id="submitBtn" class="bottomBtn">提交</button> -->
			</div>
		</bottom>
		<bottom class="bottomFixed" id = "yzglBottom">
			<div class="center clearfix" style="position: absolute;"> 
				<i id="saveBtnYzgl" onclick="saveYzglForm()"> 保存</i>
			</div>
		</bottom>
	</div>


	
	
	<div class="layBox center">清除成功</div>
</body>

<script>
		
	//char1：
	var ctx = document.getElementById("myChart").getContext('2d');
	var myChart = new Chart(ctx, {
		type: 'bar',
		data: {
			labels: ["Red", "Blue", "Yellow", "Green", "Purple", "Orange"],
			datasets: [{
				label: '# of Votes',
				data: [12, 19, 3, 5, 2, 3],
				backgroundColor: [
					'rgba(255, 99, 132, 0.2)',
					'rgba(54, 162, 235, 0.2)',
					'rgba(255, 206, 86, 0.2)',
					'rgba(75, 192, 192, 0.2)',
					'rgba(153, 102, 255, 0.2)',
					'rgba(255, 159, 64, 0.2)'
				],
				borderColor: [
					'rgba(255,99,132,1)',
					'rgba(54, 162, 235, 1)',
					'rgba(255, 206, 86, 1)',
					'rgba(75, 192, 192, 1)',
					'rgba(153, 102, 255, 1)',
					'rgba(255, 159, 64, 1)'
				],
				borderWidth: 1
			}]
		},
		options: {
			scales: {
				yAxes: [{
					ticks: {
						beginAtZero:true
					}
				}]
			}
		}
	}); 
	//char2：
	var ctx = document.getElementById("chart-0");

	var myChart = new Chart(ctx, {
	
		type: 'line',
		
		data: {
		
		 labels: ["Red", "Blue", "Yellow", "Green", "Purple", "Orange"],
		
		  datasets: [
		
		{
		
		label: '第1月',
		
		data: [12, 19, 3, 5, 2, 3],
		
		backgroundColor: ['rgba(255, 0, 0, 0.2)'],
		
		borderColor: ['rgba(255, 0, 0,0.7)'],
		
		borderWidth: 1
		
		},
		
		{
		
		label: '第2月',
		
		data: [15, 12, 3, 50, 12, 43],
		
		backgroundColor: ['rgba(0, 255, 0, 0.2)'],
		
		borderColor: [ 'rgba(0, 255, 0,0.7)'],
		
		borderWidth: 1
		
		},
		
			{
				label: '第3月',
				
				data: [45, 10, 13, 20, 12, 23],
				
				backgroundColor: ['rgba(0, 0, 255, 0.2)'],
				
				borderColor: [ 'rgba(0, 0, 255,0.7)'],
				
				borderWidth: 1 
			} 
		] 
		}, 
		options: { 
		title:{ 
		display:true, 
		text:'折线图', 
		fontSize:20, 
		fontColor:'red' 
		}, 
		scales: {
			yAxes: [{
				ticks: {
					beginAtZero:true
				}
			}]
		}
		}
	});
	var ctx = document.getElementById("chart-1");

	var myChart2 = new Chart(ctx, {

	type: 'radar',

	data: {

	labels: ["Red", "Blue", "Yellow", "Green", "Purple", "Orange"],

	datasets: [

	//一个{}表示一组数据的数据结构

	{

	fill:false,                  //是否充满

	pointStyle:'triangle',       //点的风格 'circle', 'triangle', 'rect', 'rectRot', 'cross', 'crossRot', 'star', 'line'

	label: '第1月',       //标签

	data: [12, 19, 3, 5, 2, 3],     //数据

	backgroundColor: ['rgba(255, 0, 0, 0.5)'],    //曲线与X轴之间的颜色

	borderColor: ['rgba(255, 0, 0,0.7)'],         //曲线的颜色

	piontColor:['rgba(0,255,0,1)'],               //点的颜色

	pointBackgroundColor: "rgba(255,0,0,1)",   //填充点的颜色

	borderWidth:2,                              //曲线的宽度

	showLine:true                            //曲线是显示与否

	},

	{

	label: '第2月',

	pointStyle:'rect',

	data: [15, 12, 3, 50, 12, 43],

	backgroundColor: ['rgba(0, 255, 0, 0.2)'],

	borderColor: [ 'rgba(0, 255, 0,0.7)'],

	borderWidth: 1

	},

	{

	label: '第3月',

	pointStyle:'star',

	data: [45, 10, 13, 20, 12, 23],

	backgroundColor: ['rgba(0, 0, 255, 0.2)'],

	borderColor: [ 'rgba(0, 0, 255,0.7)'],

	borderWidth: 1

	}

	]

	},

	options: {

	title:{

	display:true,

	text:'雷达图',

	fontSize:20,

	fontColor:'red'

	},

	scales: {

	xAxes:[{              //X轴属性

	display:true      //坐标轴是否显示

	}],

	yAxes: [{              //Y轴属性

	display:true,

	stacked:false,       //是否堆叠

	ticks: {

	beginAtZero:true

	}

	}]

	}

	}

	}); 
</script>

<script type="template" id="yzglTemp">  
	{{~it.data :value:index}}
	{{var textArray = ['col19','col20','col39','col40','col59','col60','col79','col80','col99','col100','col119','col120','col139','col140','col159','col160','col179','col180','col199','col200'];}}
		<div style="border: 0.04267rem solid #aaa; margin-top: 5px;">
			<p style="text-align:center;color:blue;text-decoration:underline" id = {{=index}} onclick=hideShowQy(this)>{{= value.qymc}}</p>
			<div id = {{= "qyDiv_" + index}}>
				{{? value.qyremark}} 
					<p style="font-size:0.5rem;color:gray;line-height:56px">{{= value.qyremark}}</p>
				{{?}}  
				{{~value.fields :fieldValue:fieldIndex}}
					<p id={{= fieldValue.columnName + 'titleP'}}>{{= fieldValue.columnTitle}}</p>
					{{? fieldValue.remark}} 
						<p style="font-size:0.5rem;color:gray;line-height:56px">{{= fieldValue.remark}}</p>
					{{?}}  

					{{? textArray.indexOf(fieldValue.columnName) == 0}} 
						<textarea id={{= fieldValue.columnName}} name={{= fieldValue.columnName}} onpropertychange="MaxMe(this)" oninput="MaxMe(this)" style="overflow:hidden; margin-top: 3px;"></textarea>
					{{??}}
						<p>
							<select value="" id={{= fieldValue.columnName}} name={{= fieldValue.columnName}} onchange="openOtherText(this)">
								<option value="合格">合格</option>
								<option value="其他情况">其他情况</option>
							</select>
							<textarea id={{= fieldValue.columnName + 'textarea'}} name={{= fieldValue.columnName + 'textarea'}} placeholder="请输入其他情况" onpropertychange="MaxMe(this)" oninput="MaxMe(this)" style="overflow:hidden; display: none; margin-top: 3px;"></textarea>
						</p>
					{{?}}  
				{{~}}
			</div>
		</div>
    {{~}}
</script>

<!-- chart结束 -->
<script> 

	var needCheckArra = [];

	var yzglJson = {
		// departCode: $("#departCodeSelect").val(),
		departCode: 10779,
		tableName: "DEV_WEEKLY_CHECK"
	}
	var url = getURL() + '/mobile/devWeeklyCheckController.do?getCheckListCols';

	sendPostDownLoad(url, yzglJson, yzglResponseFunc)
	function yzglResponseFunc(data) {
		debugger
		if (data.success == 'true') {
			var tmpl = doT.template($("#yzglTemp").text());  
			var res = {};
			var yzglData = [];
			var keyNameStore = {};
			res.data = data.data.colsData;
			$("#yzglPart2").html(tmpl(res));  
			var textArray = ['col19','col20','col39','col40','col59','col60','col79','col80','col99','col100','col119','col120','col139','col140','col159','col160','col179','col180','col199','col200'];
			$.each(data.data.colsData, function() {
				$.each(this.fields, function() {

					keyNameStore[this.columnName] = this.columnTitle;

					if (window.JsCallback) {  

						if (textArray.indexOf(this.columnName) != 0) {
							$('#' + this.columnName).fancySelect(); 
						}
					}
					if (this.columnRequire == 1) {
						var titleName = this.columnTitle + "<span class='yzglSpan'>*</span>";
						$("#" + this.columnName + "titleP").html('').html(titleName)
						needCheckArra.push(this.columnName);
					}
				})
			}) 

			var fgsStr = '';
			$.each(data.data.fgsData, function() {
				fgsStr+="<option value="+this.departname+">"+this.departname+"</option>"

			})
			$("#fgsmc").html(fgsStr); 

			var yzStr = '';
			$.each(data.data.jyzData, function() {
				yzStr+="<option value="+this.departname+">"+this.departname+"</option>"

			})
			$("#yzbm").html(yzStr); 
			
			keyNameStore.fgsmc = '分公司';
			keyNameStore.yzbm = '油站名称';
			keyNameStore.zjrq = '周检日期';
			keyNameStore.zjry = '周检人员';
			
			localStorage.setItem("keyNameStore",JSON.stringify(keyNameStore));

		}
	}



	function MaxMe(o) {
		if (o.scrollHeight < 110) {

		} else {
			o.style.height = o.scrollTop + o.scrollHeight + "px";
		}
	}
	
	function openOtherText(v) {
		if (v.value == '其他情况') {
			$("#" + v.id + "textarea").show();
		} else if (v.value == '合格') {
			$("#" + v.id + "textarea").hide();
		}
	}

	function hideShowQy(v) {
		if ($("#qyDiv_" + v.id).is(':visible')) {
			$("#qyDiv_" + v.id).hide();
		} else {
			$("#qyDiv_" + v.id).show();
		}
	}

	var yzglCameraUrl1 = '';
	var yzglCameraUrl2 = '';
	var yzglCameraUrl3 = '';
	function uploadYzglImg(obj, id) {
		var file = obj.files[0];
		var mime_type=file.type;
		var orientation=0;
		if (file && /^image\//i.test(file.type)) {
			EXIF.getData(file,function(){
			orientation=EXIF.getTag(file,'Orientation');
			});
			var image=new Image();

			var reader = new FileReader();
			reader.onloadend = function () {
				var url = reader.result;//读取到的文件内容.这个属性只在读取操作完成之后才有效,并且数据的格式取决于读取操作是由哪个方法发起的.所以必须使用reader.onload，
				image.src = url;//reader读取的文件内容是base64,利用这个url就能实现上传前预览图片
			var width,height;
			var MAX_WH=800;
			image.onload=function () {
				if(image.height > MAX_WH) {
				// 宽度等比例缩放 *= 
				image.width *= MAX_WH / image.height;
				image.height = MAX_WH;
				}
				if(image.width > MAX_WH) {
				// 宽度等比例缩放 *= 
				image.height *= MAX_WH / image.width;
				image.width = MAX_WH;
				}
				//压缩
				var quality=80;
				var cvs = document.createElement('canvas');
				cvs.width = width = image.width;
				cvs.height =height = image.height;
		
				switch (orientation) {
				case 6:
				case 8:
					cvs.width = height;
					cvs.height = width;
					break;
				}
		
				var context=cvs.getContext("2d");
		
				//解决ios图片旋转问题 
				switch(orientation){
				//iphone横屏拍摄，此时home键在左侧
				case 3:
				// 180度向左旋转
				context.translate(width, height);
				context.rotate(Math.PI);
				break;
				//iphone竖屏拍摄，此时home键在下方(正常拿手机的方向)
				case 6:
				context.rotate(0.5 * Math.PI);
				context.translate(0, -height);
				break;
				//iphone竖屏拍摄，此时home键在上方
				case 8:
				// 逆时针旋转90度
				context.rotate(-0.5 * Math.PI);
				context.translate(-width, 0);
				break;
				}
				context.drawImage(image, 0, 0,image.width, image.height);
				var base64 = cvs.toDataURL('image/jpeg', quality/100);
				debugger
				$("#" + id).css("background-image","url(" + base64 + ")");
				
				if (id == 'yzglImg1') {
					yzglCameraUrl1 = base64;
				} else if(id == 'yzglImg2') {
					yzglCameraUrl2 = base64;
				} else if(id == 'yzglImg3') {
					yzglCameraUrl3 = base64;
				}
				
				//获取识别结果
					// zcpdImgs.unshift(base64);
					// $("#zcpdImgsDiv").html("");
					// $("#pyImgsDiv").html("");
					// zcpdImgs.forEach(function(value, index) {
					// 	if ($('.scrollCon1').css('display') == "block") {
					// 		$("#zcpdImgsDiv").append("<div class=\"swiper-slide\">" + "<img src=\"" + value + "\"/>" + "</div>");
					// 	} else if ($('.scrollCon2').css('display') == "block") {
					// 		$("#pyImgsDiv").append("<div class=\"swiper-slide\">" + "<img src=\"" + value + "\"/>" + "</div>");
					// 	}
					// })
					// $("#zcpdImgsDiv").html(value);
					}
				//   image.src=base64;
				};
			reader.readAsDataURL(file);
		}else{
			alert("只能识别图片！")
		}
	}

	function saveYzglForm() {
		
		var formEntry3Data = $("#formEntry3").serializeObject();
		$.each(formEntry3Data,function(name,value) {
			if(value == "其他情况") {
				var textStr = name + "textarea";
				formEntry3Data[name] = formEntry3Data[textStr];
			}
		});
		
		debugger
		var checkResult = true;
		$.each(needCheckArra, function(index, name) {
			if (!formEntry3Data[name]) {
				alert("您有必填项未填写");
				checkResult = false;
				return false;
			}
		})
		if (!checkResult) {
			return false;
		}
		// formEntry3Data.yzglCameraUrl1 = yzglCameraUrl1;
		// formEntry3Data.yzglCameraUrl2 = yzglCameraUrl2;
		// formEntry3Data.yzglCameraUrl3 = yzglCameraUrl3;

		var img = [];
		img.push(yzglCameraUrl1);
		img.push(yzglCameraUrl2);
		img.push(yzglCameraUrl3);
		formEntry3Data.uploadFile = img;

		localStorage.setItem("zjbDataStorage",JSON.stringify($("#formEntry3").serializeObject()));
		
		formEntry3Data.uploadTableName = 'zjb';

		if (window.JsCallback) {
			var res = window.JsCallback.saveZjb(formEntry3Data);
			if (res) {
				alert("保存成功");
			}
		} else {
			setupWebViewJavascriptBridge(function (bridge) {
				bridge.callHandler('saveZjb', formEntry3Data, function responseCallback(result) {
					if (result) {
						alert("保存成功");
					}

				})
			})
		}


	}


	var cfddJson;
	if (window.JsCallback) {
		var cfddStr = window.JsCallback.onGetCFDD();
		if (cfddStr) {
			cfddJson = JSON.parse(cfddStr)
			var cfddOptionStr = "<option value=''></option>";
			$.each(cfddJson,function(index,i){  
				cfddOptionStr+="<option value="+this.complexname+">"+this.complexname+"</option>"
			})   
			$('#formEntry').find("#storePlaceName").html(cfddOptionStr);
			$('#formEntry2').find("#storePlaceName").html(cfddOptionStr);

		}
	} else {
		setupWebViewJavascriptBridge(function (bridge) {
			bridge.callHandler('onGetCFDD', function responseCallback(res) { 
			if (res) {
					cfddJson = res;
					var cfddOptionStr = "<option value=''></option>";
					$.each(cfddJson,function(index,i){  
						
						cfddOptionStr+="<option value="+this.complexname+">"+this.complexname+"</option>"
					})   
					
					$('#formEntry').find("#storePlaceName").html(cfddOptionStr);
					$('#formEntry2').find("#storePlaceName").html(cfddOptionStr);

				}
			})
		});
	}

	var pyyyJson;
	if (window.JsCallback) {
		var pyyyStr = window.JsCallback.onGetPYYY();
		if (pyyyStr) {
			pyyyJson = JSON.parse(pyyyStr);
			var pyyyOptionStr =  "<option value=''></option>";
			$.each(pyyyJson,function(index,i){  
				
				pyyyOptionStr+="<option value="+this.complexname+">"+this.complexname+"</option>"
			})   
			
			$("#lossReason").html(pyyyOptionStr);
		}
	} else {
		setupWebViewJavascriptBridge(function (bridge) {
			bridge.callHandler('onGetPYYY', function responseCallback(res) { 
			if (res) {
				pyyyJson = res;
				var pyyyOptionStr = "<option value=''></option>";
				$.each(pyyyJson,function(index,i){  
					
					pyyyOptionStr+="<option value="+this.complexname+">"+this.complexname+"</option>"
				})   
				
				$("#lossReason").html(pyyyOptionStr);
			}
			})
		});
	}

	$('#lossReason').select2({
		tags: true
	});

	// debugger
	$('#formEntry').find("#storePlaceName").select2({
		tags: true
	});

	$('#formEntry2').find("#storePlaceName").select2({
		tags: true
	});


	//-----------------------周检start-----------------------------------------
	var lcalendarData='1900-1-1'+',2030-12-31'
    $("#zjrq").attr("data-lcalendar",lcalendarData); 
    $("#zjrq").val(new Date().Format('yyyy-MM-dd')) 
    var calendardatetime = new lCalendar();
    calendardatetime.init({
        'trigger': '#zjrq ',
        'type': 'date',
        'minDate':'1900-1-1',//最小日期 注意：该值会覆盖标签内定义的日期范围
	}); 
	
	


//请求数据
if (window.JsCallback) {
        //安卓            
        callbackGetServerConfig(window.JsCallback.onGetServerConfig());
    } else {
        //IOS 
        setupWebViewJavascriptBridge(function (bridge) {
            bridge.callHandler('getCurrentServerConfig', callbackGetServerConfig)
        })
    }

    function callbackGetServerConfig(result) { 
        if (result!= null&&result!= "") {            
            var urlJson = JSON.parse(result);
			var pUrl =  urlJson[0]+"://" + urlJson[1] + ":" + urlJson[2] + "/" + urlJson[3];
            sessionStorage.setItem('postUrl',pUrl)
            $.cookie('postUrl', pUrl, { expires: 7, path: '/', secure: false });
        }
    }

//select 
var saveData={}; 
var pany=0;
	if (window.JsCallback) {  
		$('#assetsStatus').fancySelect(); 
		//$('#checkResult').fancySelect();  
		$('#realcodeStatus').fancySelect();  
	}
	//$('#checkResult').val("1");  
	$('#realcodeStatus').val("0");  
	if (window.JsCallback) {  
		// $('select').fancySelect(); 
		$('#technicalCondition').fancySelect();  
	}

	//开发调试临时注释掉  -xiongzy
	$(".outLine").click(function () {
		$(".navCon").html("资产盘点");

		zcpdImgs = [];
		$("#zcpdImgsDiv").html("");
		// $("#Hbox1").addClass("active");
		// $(".scrollCon1").show(); 
		// $(".scrollCon2").hide();
		
		if (window.JsCallback) {
			//判断是否开启了飞行模式
			if (window.JsCallback.onGetIsAirplaneMode()) {
				$("#Hbox1").addClass("active");
				$(".scrollCon1").show(); 
				$(".scrollCon2").hide();
				$(".scrollCon3").hide();

			}else {
				alert("请切换飞行模式");
				$("#Hbox1").removeClass("active");
			}
		} else {
			if (window.navigator.onLine == true) {
				alert("请切换飞行模式");
				$("#Hbox1").removeClass("active");
			} else {
				$("#Hbox1").addClass("active");
				$(".scrollCon1").show(); 
				$(".scrollCon2").hide();
				$(".scrollCon3").hide();

			}
			// $("#Hbox1").addClass("active");
			// 	$(".scrollCon1").show(); 
			// 	$(".scrollCon2").hide();
		}

		
	}) 

	$("#pyEntry").click(function () {
		// if (window.JsCallback) {
		// 	//判断是否开启了飞行模式
		// 	if (window.JsCallback.onGetIsAirplaneMode()) {
		// 	}else {
		// 		alert("请切换飞行模式");
		// 		return false;
		// 	}
		// } else {
		// 	if (window.navigator.onLine == true) {
		// 		alert("请切换飞行模式");
		// 		return false;
		// 	}
		// }

		pyFrom = 0;
		zcpdImgs = [];
		$(".navCon").html("盘盈录入");
		$("#pyImgsDiv").html("");
		$("#Hbox1").addClass("active");
		$(".scrollCon1").hide(); 
		$(".scrollCon2").show();
		$(".scrollCon3").hide();

		// alert(123)
		// $(".scrollCon2").show();
		// 	$(".scrollCon1").hide();
		// 	$("#PLnum").text(PLnum); 

	}) 
	
	$(".navFooter li").click(function () {
		$(".navFooter li").removeClass("active");
		$(this).addClass("active");
		var tabStatus = $(this).attr("tabS");
		if (tabStatus == $(this).attr("tabS")) {
			$("#indexGoBack").hide();
			$("#tjcxLinkView").hide();
			$("#dbglLinkView").hide();
			$("#bfglLinkView").hide();
			$("#zcpdLinkView").hide();
			$(".linkView2").show();
		}
		$(".mytabs").removeClass("active");
		$("." + tabStatus).addClass("active");
	}) 
</script>
<script>
	// 判断是否登陆
	function userINFO(){
		// var departListStr = $.cookie('departList');
		var departListStr = localStorage.getItem('departList');

		var userInfo = $.cookie('userinfo'); 
		if(departListStr&&userInfo && departListStr !== "null"){ 
			departList = JSON.parse(departListStr)[0];
			userInfo = JSON.parse(userInfo);  
			$(".userInfo .DepartName").text(userInfo.departname);
			$(".userInfo .UserName").text(userInfo.username); 
			// $("#pyManagerDepart").val(userInfo.departname);
			// $("#pyDepartCode").val(userInfo.departcode);
		}  
	}
	userINFO();

	function getdepartList (){ 
		// var PDdepartlist = $.cookie('PDdepartlist');
		var PDdepartlist = localStorage.getItem('PDdepartlist');
		if(PDdepartlist) {
			PDdepartlist = JSON.parse(PDdepartlist);
			resD(PDdepartlist); 
		}
	}
    //单位列表
    getdepartList ()
	function resD(data){ 
		var str='';
		if(data.length>0){ 
			$.each(data,function(i,that){ 
				str+="<option value="+that.departCode+">"+that.departName+"</option>"
			})
		}else{
			// var departList = $.cookie('departList');
			var departList = localStorage.getItem('departList');

			departList = JSON.parse(departList);
			$.each(departList,function(){ 
				str+="<option value="+this.departcode+">"+this.shortname+"</option>"
			})
		}
			$("#pyDepartCode").html(str); 
			if (window.JsCallback) { 
				$('#pyDepartCode').fancySelect(); 
			}
	}

	// 搜索
	$("#search").click(function () {
		var scanData = "";
		$("#zcpdImgsDiv").html("");
		$("#pyImgsDiv").html("");
		var lid = $("#lid").val();
		if(lid.trim()==''){
			alert('请输入需要搜索的资产条码')
			return false;
		}
		if (window.JsCallback) {
			var data=window.JsCallback.onGetDeviceById(lid);  
			renderData($("#formEntry"), data);
		} else {
			setupWebViewJavascriptBridge(function (bridge) {
				bridge.callHandler('getJSONWithDeviceId', lid, function responseCallback(result) {
					renderData($("#formEntry"), result);

				})
			})
		}
	})

	//资产盘点拍照
	var zcpdImgs = [];
// 	function ImgToBase64(file, maxLen, callBack) {
//     var img = new Image();
// 	var orientation=0;
// 	EXIF.getData(file,function(){
//       orientation=EXIF.getTag(file,'Orientation');
//     });
//     var reader = new FileReader();//读取客户端上的文件
//     reader.onload = function () {
//         var url = reader.result;//读取到的文件内容.这个属性只在读取操作完成之后才有效,并且数据的格式取决于读取操作是由哪个方法发起的.所以必须使用reader.onload，
//         img.src = url;//reader读取的文件内容是base64,利用这个url就能实现上传前预览图片
//     };
//     img.onload = function () {
//         //生成比例
//         var width = img.width, height = img.height;
//         //计算缩放比例
//         var rate = 1;
//         if (width >= height) {
//             if (width > maxLen) {
//                 rate = maxLen / width;
//             }
//         } else {
//             if (height > maxLen) {
//                 rate = maxLen / height;
//             }
//         };
//         img.width = width * rate;
// 		img.height = height * rate;
// 		var canvas = document.createElement("canvas");
// 		canvas.width = img.width;
//         canvas.height = img.height;
// 		switch (orientation) {
//           case 6:
//           case 8:
// 		  canvas.width = height;
// 		  canvas.height = width;
//             break;
//         }
//         //生成canvas
// 		var ctx = canvas.getContext("2d");
// 		//解决ios图片旋转问题 
//         switch(orientation){
//           //iphone横屏拍摄，此时home键在左侧
//           case 3:
//           // 180度向左旋转
//           ctx.translate(width, height);
//           ctx.rotate(Math.PI);
//           break;
//           //iphone竖屏拍摄，此时home键在下方(正常拿手机的方向)
//           case 6:
//           ctx.rotate(0.5 * Math.PI);
//           ctx.translate(0, -height);
//           break;
//           //iphone竖屏拍摄，此时home键在上方
//           case 8:
//           // 逆时针旋转90度
//           ctx.rotate(-0.5 * Math.PI);
//           ctx.translate(-width, 0);
//           break;
//         }
        
//         ctx.drawImage(img, 0, 0, img.width, img.height);
//         var base64 = canvas.toDataURL('image/jpeg', 0.8);
//         callBack(base64);
//     };
//     reader.readAsDataURL(file);
// }

	function changeImg(obj) {
		var file = obj.files[0];
  var mime_type=file.type;
  var orientation=0;
  if (file && /^image\//i.test(file.type)) {
    EXIF.getData(file,function(){
      orientation=EXIF.getTag(file,'Orientation');
    });
	var image=new Image();

    var reader = new FileReader();
    reader.onloadend = function () {
        var url = reader.result;//读取到的文件内容.这个属性只在读取操作完成之后才有效,并且数据的格式取决于读取操作是由哪个方法发起的.所以必须使用reader.onload，
        image.src = url;//reader读取的文件内容是base64,利用这个url就能实现上传前预览图片
      var width,height;
      var MAX_WH=800;
      image.onload=function () {
        if(image.height > MAX_WH) {
          // 宽度等比例缩放 *= 
          image.width *= MAX_WH / image.height;
          image.height = MAX_WH;
        }
        if(image.width > MAX_WH) {
          // 宽度等比例缩放 *= 
          image.height *= MAX_WH / image.width;
          image.width = MAX_WH;
        }
        //压缩
        var quality=80;
        var cvs = document.createElement('canvas');
        cvs.width = width = image.width;
        cvs.height =height = image.height;
 
        switch (orientation) {
          case 6:
          case 8:
            cvs.width = height;
            cvs.height = width;
            break;
        }
 
        var context=cvs.getContext("2d");
 
        //解决ios图片旋转问题 
        switch(orientation){
          //iphone横屏拍摄，此时home键在左侧
          case 3:
          // 180度向左旋转
          context.translate(width, height);
          context.rotate(Math.PI);
          break;
          //iphone竖屏拍摄，此时home键在下方(正常拿手机的方向)
          case 6:
          context.rotate(0.5 * Math.PI);
          context.translate(0, -height);
          break;
          //iphone竖屏拍摄，此时home键在上方
          case 8:
          // 逆时针旋转90度
          context.rotate(-0.5 * Math.PI);
          context.translate(-width, 0);
          break;
        }
        context.drawImage(image, 0, 0,image.width, image.height);
		var base64 = cvs.toDataURL('image/jpeg', quality/100);
		//获取识别结果
			if(zcpdImgs.length > 2) {
				alert("最多只能上传3张");
				return false;
			}
			zcpdImgs.unshift(base64);
			$("#zcpdImgsDiv").html("");
			$("#pyImgsDiv").html("");
			zcpdImgs.forEach(function(value, index) {
				if ($('.scrollCon1').css('display') == "block") {
					$("#zcpdImgsDiv").append("<div class=\"swiper-slide\">" + "<img src=\"" + value + "\"/>" + "</div>");
				} else if ($('.scrollCon2').css('display') == "block") {
					$("#pyImgsDiv").append("<div class=\"swiper-slide\">" + "<img src=\"" + value + "\"/>" + "</div>");
				}
			})
			// $("#zcpdImgsDiv").html(value);
      }
    //   image.src=base64;
    };
    reader.readAsDataURL(file);
  }else{
    alert("只能识别图片！")
  }
// 		var file = obj.files[0];
// 		ImgToBase64(file, 720, function (base64) {
// //                 $("#img1")[0].src = base64;//预览页面上预留一个img元素，载入base64
// //                 $("#img1")[0].width = 300;//设定宽高，不然会自动按照压缩过的图片宽高设定，有可能超出预想的范围。
// // 　　　　　　　　　　　//直接利用ajax上传base64到服务器，完毕
// 			zcpdImgs.unshift(base64);
// 				$("#zcpdImgsDiv").html("");
// 				$("#pyImgsDiv").html("");
// 				zcpdImgs.forEach(function(value, index) {
// 					if ($('.scrollCon1').css('display') == "block") {
// 						$("#zcpdImgsDiv").append("<div class=\"swiper-slide\">" + "<img src=\"" + value + "\"/>" + "</div>");
// 					} else if ($('.scrollCon2').css('display') == "block") {
// 						$("#pyImgsDiv").append("<div class=\"swiper-slide\">" + "<img src=\"" + value + "\"/>" + "</div>");
// 					}
// 				})
// 				// $("#zcpdImgsDiv").html(value);
//             });
	}

	// function changeImg(obj) {
	// 	debugger
	// 	if (!obj.files.length) return;

	// 	var file = obj.files[0];

	// 	var reader = new FileReader();
	// 	reader.onload = function () {
	// 		// debugger
	// 		var result = this.result;    //data:base64    
	// 		zcpdImgs.unshift(result);
	// 		$("#zcpdImgsDiv").html("");
	// 		$("#pyImgsDiv").html("");
	// 		zcpdImgs.forEach(function(value, index) {
	// 			if ($('.scrollCon1').css('display') == "block") {
	// 				$("#zcpdImgsDiv").append("<div class=\"swiper-slide\">" + "<img src=\"" + value + "\"/>" + "</div>");
	// 			} else if ($('.scrollCon2').css('display') == "block") {
	// 				$("#pyImgsDiv").append("<div class=\"swiper-slide\">" + "<img src=\"" + value + "\"/>" + "</div>");
	// 			}
	// 		})
	// 		// $("#zcpdImgsDiv").html(value);

	// 		// console.log(result);
	// 		// $.post('/upload', {'base64': result}, function(result) {
	// 		// });
	// 	};
	// 	// debugger
	// 	reader.readAsDataURL(file);

	// }

	//扫描条形码功能    
	$("#scanning").click(function () {
		var scanData = "";
		if (window.JsCallback) {
			//安卓
			window.JsCallback.onQR();
		} else {
			//IOS 
			setupWebViewJavascriptBridge(function (bridge) {
				bridge.callHandler('scanQR_AI', function responseCallback(responseData) {
					renderData($("#formEntry"), responseData);
				})

			})
		}
	})
	//此方法用于给Android系统调用
	function rnSetQRResult(result) {
		renderData($("#formEntry"), result);
	} 
	var pyFrom = 0;
	function renderData(dom, data) { 
		var scanData = JSON.parse(data); 
		saveData=scanData;
		if(!data || scanData.QRCodeLPC){
			$("#dialog-confirm").show(); 
            $("#sure").click(function(){
				$("#dialog-confirm").hide(); 
				pyFrom = 1;
				$(".navCon").html("盘盈录入");
				$(".scrollCon2").show();
				$(".scrollCon1").hide();
				$(".scrollCon3").hide();

				var PLnum = sessionStorage.getItem("plnum");
				$("#PLnum").text(PLnum); 
				$("#Hbox2 input[name=barCode]").val(scanData.QRCodeLPC);
				// $('select').fancySelect(); 
			})
			$("#cancle").click(function(){
                $("#dialog-confirm").hide()
                return false
            })  
			
		}else{
			$(".scrollCon1").show(); 
			$(".scrollCon2").hide(); 
			$(".scrollCon3").hide();

			var keyCode = scanData.keyCode; 
			$('#keyCode').val(keyCode);
			$("#lid").val(scanData.barCode)
			$.each(dom.find("input[name],select[name]"), function () {
				var that = $(this);
				var nameData = $(this).attr('name');
				var jValue = ""
				for (var item in scanData) {
					if (item == nameData) {  //item 表示Json串中的属性，如'name'  
						jValue = scanData[item];//key所对应的value  
						if(nameData == "assetsStatus" && jValue=="") {

						} else if(nameData == "realcodeStatus" && (jValue=="" || jValue==null || !jValue)) {
							$('#realcodeStatus').val("0");  
						} else {
							that.val(jValue == "" ? "" : jValue);
							return;
						}
					}
				}

			})
			if (!!scanData.zcpdImgs) {
				zcpdImgs = scanData.zcpdImgs;
				zcpdImgs.forEach(function(value, index) {
					if ($('.scrollCon1').css('display') == "block") {
						$("#zcpdImgsDiv").append("<div class=\"swiper-slide\">" + "<img src=\"" + value + "\"/>" + "</div>");
					} else if ($('.scrollCon2').css('display') == "block") {
						$("#pyImgsDiv").append("<div class=\"swiper-slide\">" + "<img src=\"" + value + "\"/>" + "</div>");
					}
				})
			}
		}  

	}
	function S4() {
	return (((1+Math.random())*0x10000)|0).toString(16).substring(1);
	}
	function guid() {
	return (S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4());
	}
	function guid() {
		function S4() {
		return (((1+Math.random())*0x10000)|0).toString(16).substring(1);
		}
		return (S4()+S4()+S4()+S4()+S4()+S4()+S4()+S4());
	}
	//保存数据 到本机
	$("#submitBtn").click(function () { 
		var pan_1=localStorage.getItem("pan_1")==undefined?0:localStorage.getItem("pan_1"),  
		pan_3=localStorage.getItem("pan_3")==undefined?0:localStorage.getItem("pan_3");
		var formBox = {};
		if($("#formEntry").is(":hidden")){ 
			pany=1;
			formData = $("#formEntry2").serializeObject();
			if (!formData.barCode) {
				formData.barCode = guid();
			}
			if(!formData.assetsName || !formData.storePlaceName || !formData.technicalCondition ||
				!formData.userPerson || !formData.assetsStatus || !formData.lossReason || !formData.assetsStandard) {
				alert("有必传字段未填写");
				return false;
			}
			
			formData.keyCode=guid();
			formData.checkResult=3;
			formData.departCode = $("#pyDepartCode").val();
			formData.managerDepart = $("#pyDepartCode").val();

			if (window.JsCallback) {
			 	formData.realcodeStatus =$('#realcodeStatus').next().next().find(".selected").attr("data-raw-value");
				formData.assetsStatus=$('#assetsStatus').next().next().find(".selected").attr("data-raw-value");
				formData.assetsStatusName=$('#assetsStatus').next().next().find(".selected").text();
				
			}else{ 
				formData.realcodeStatus =$('#realcodeStatus').val();
				formData.assetsStatus=$('#assetsStatus').val();
				formData.assetsStatusName=$('#assetsStatus').find("option:selected").text();
			} 
			
			var managerDepartName = "";

			// var PDdepartlist = $.cookie('PDdepartlist');
			var PDdepartlist = localStorage.getItem('PDdepartlist');
			PDdepartlist = JSON.parse(PDdepartlist);
			$.each(PDdepartlist,function(){
				var that = this;   
				if(that.departCode == $("#pyDepartCode").val()) {
					$("#pyManagerDepart").val(that.departName);
					managerDepartName = that.departName;
					return;
				}
			})
			formData.managerDepartName = managerDepartName;
			formData.planNumber = localStorage.getItem('plnum');

			localStorage.setItem("pan_3",Number(pan_3)+1);
			var clientData = Object.assign(saveData,formData); 
			clientData.zcpdImgs = zcpdImgs;
			clientData.fileName = "/mnt/sdcard/assets/" + clientData.barCode +"_"+ new Date().Format('yyyyMMdd-hhmmss')+".jpg";
			clientData = JSON.stringify(clientData);
		}else{ 
			formData = $("#formEntry").serializeObject();  
			// if(!formData.assetsStatus || !formData.realcodeStatus || !formData.technicalCondition ||
			// 	!formData.userPerson) {
			// 	alert("有必传字段未填写");
			// 	return false;
			// }
			if (!formData.barCode) {
				alert("请识别条码");
				return false;
			}
			if (!formData.storePlaceName) {
				alert("存放地点未填写");
				return false;
			}
			
			formData.keyCode=$("#keyCode").val();
				formData.checkResult=1;
			if (window.JsCallback) {
			 	formData.realcodeStatus =$('#realcodeStatus').next().next().find(".selected").attr("data-raw-value");
				formData.assetsStatus=$('#assetsStatus').next().next().find(".selected").attr("data-raw-value");
				formData.assetsStatusName=$('#assetsStatus').next().next().find(".selected").text();
				
			}else{ 
				formData.realcodeStatus =$('#realcodeStatus').val();
				formData.assetsStatus=$('#assetsStatus').val();
				formData.assetsStatusName=$('#assetsStatus').find("option:selected").text();
			} 
			var clientData = Object.assign(saveData,formData); 
			clientData.zcpdImgs = zcpdImgs;
			clientData.fileName = "/mnt/sdcard/assets/" + clientData.barCode +"_"+ new Date().Format('yyyyMMdd-hhmmss')+".jpg";

			clientData = JSON.stringify(clientData); 
		}     
		if(pany == 1){
			localStorage.setItem("pan_3",Number(pan_3)+1);
			pany=0;
		}else{
//存查询时候的数目（存在）  //加上去重！！！barcode
			if (window.JsCallback) {
				var res = window.JsCallback.onGetStashedDeviceInfoList() ;
				if (res == null || !res) {            
					localStorage.setItem("pan_1",Number(pan_1)+1);
				}else{
					var sendData = JSON.parse(res); 
					//去重
					var barcode = $("#lid").val();
					var resList = sendData.filter(function(index) {
						return  JSON.parse(index).barCode==barcode;
					})   
					if(resList.length<=0){localStorage.setItem("pan_1",Number(pan_1)+1);}
				}
			} else {
				setupWebViewJavascriptBridge(function (bridge) {
					bridge.callHandler('getTobesubmitArray', function(data){
						var res = data;
						if (res == null || !res) {            
							localStorage.setItem("pan_1",Number(pan_1)+1);
						}else{
							var sendData = JSON.parse(res); 
							//去重
							var barcode = $("#lid").val();
							var resList = sendData.filter(function(index) {
								return  JSON.parse(index).barCode==barcode;
							})   
							if(resList.length<=0){localStorage.setItem("pan_1",Number(pan_1)+1);}
						}
					})
				})
			}
		}
		if (window.JsCallback) {
			var res = window.JsCallback.onStashDeviceInfo (clientData);
			if (res) {
				var userInfo = JSON.parse($.cookie('userinfo'));  
				alert("保存成功");
				document.getElementById("formEntry").reset();
				// $("#pyManagerDepart").val(userInfo.departname);
				$("#lid").val("");
				zcpdImgs = [];
				$("#zcpdImgsDiv").html("");
				$("#pyImgsDiv").html("");
				if(pyFrom == 1) {
					$(".navCon").html("资产盘点");
					$(".scrollCon1").show();
					$(".scrollCon2").hide();
					$(".scrollCon3").hide();

				}
			}
		} else {
			setupWebViewJavascriptBridge(function (bridge) {
				bridge.callHandler('saveTobesubmit', clientData, function responseCallback(result) {
					if (result) {
						var userInfo = JSON.parse($.cookie('userinfo'));  
						alert("保存成功");
						document.getElementById("formEntry").reset();
						document.getElementById("formEntry2").reset();
						// $("#pyManagerDepart").val(userInfo.departname);
						$("#lid").val("");
						zcpdImgs = [];
						$("#zcpdImgsDiv").html("");
						$("#pyImgsDiv").html("");			
						if(pyFrom == 1) {
							$(".navCon").html("资产盘点");
							$(".scrollCon1").show();
							$(".scrollCon2").hide();
							$(".scrollCon3").hide();

						}
					}

				})
			})
		}

	})
	$(".backOn").click(function () { 
		$(".navCon").html("应用");

		$(".indexBox").removeClass("active");
		if (!$("#jyzglLinkView").is(':hidden')) {
			localStorage.setItem("zjbDataStorage",JSON.stringify($("#formEntry3").serializeObject()));
		}
	})
	var qustString = getURL()+"/mobile/allotController.do?getDeparts";

	var qustPyString = getURL()+"/mobile/dictionariesController.do?getPyyyDic";
	var qustCfddString = getURL()+"/mobile/dictionariesController.do?getCfddDic";


	var departList = localStorage.getItem('departList');

    var userInfo = $.cookie('userinfo'); 
    departList = JSON.parse(departList)[0];
    userInfo = JSON.parse(userInfo); 
	$(".updateDepart").click(function () {    
		var jsons = {
            userCode: userInfo.usercode
            // departCode: userInfo.departcode 
        } ;  
		sendPostDownLoad(qustString, jsons, updateDepartCallBack);
		sendGet(qustPyString, jsons, updatePyCallBack);
		sendGet(qustCfddString, jsons, updateCfddCallBack);

	})

	function updateDepartCallBack(data) {
		if (data.data) {
			var res =JSON.stringify(data.data);
			if (window.JsCallback) {
				var result = window.JsCallback.onSaveDeparts(res);
				if(result){
					alert("更新成功");
				}
			} else {
				setupWebViewJavascriptBridge(function (bridge) {
					bridge.callHandler('onSaveDeparts',res,function responseCallback(result) {
						if(result){
							alert("更新成功");
						}
					})
				})
			}
		} else {
			alert("未查询到更新的单位信息")
		}
		
	}

	function updatePyCallBack(data) {
		if (data.data) {
			var res =JSON.stringify(data.data);
			if (window.JsCallback) {
				var result = window.JsCallback.onSavePYYY(res);
				if(result){
					// alert("更新成功");
				}
			} else {
				setupWebViewJavascriptBridge(function (bridge) {
					bridge.callHandler('onSavePYYY',res,function responseCallback(result) {
						if(result){
							// alert("更新成功");
						}
					})
				})
			}
		} else {
			// alert("未查询到更新的单位信息")
		}
		
	}

	function updateCfddCallBack(data) {
		if (data.data) {
			var res =JSON.stringify(data.data);
			if (window.JsCallback) {
				var result = window.JsCallback.onSaveCFDD(res);
				if(result){
					// alert("更新成功");
					history.go(0)
				}
			} else {
				setupWebViewJavascriptBridge(function (bridge) {
					bridge.callHandler('onSaveCFDD',res,function responseCallback(result) {
						if(result){
							// alert("更新成功");
							history.go(0)
						}
					})
				})
			}
		} else {
			// alert("未查询到更新的单位信息")
		}
		
	}


	$(".delateData").click(function () {    
		if (window.JsCallback) {
			var result = window.JsCallback.onClearCache();
			if(result){
				delateCookie()
			}
		} else {
			setupWebViewJavascriptBridge(function (bridge) {
				bridge.callHandler('onClearCache',function responseCallback(result) {
					if(result){
						delateCookie()
					}
				})
			})
		}
	})
	function delateCookie(){
		$.cookie('departList', null,{ expires: 30, path: '/', secure: false });
		$.cookie('userinfo', null,{ expires: 30, path: '/', secure: false });
		$.cookie('postUrl', "",{ expires: 30, path: '/', secure: false });	
		//改成弹窗然后消失
		$(".layBox").show()
		setTimeout(function(){ $(".layBox").hide()},1000) ;
		setTimeout(function(){ history.go(0)},1200);
		localStorage.removeItem('pdjhCount');
		localStorage.removeItem('plnum');
		localStorage.removeItem('planName');
		localStorage.removeItem('planStartDate');
		localStorage.removeItem('planStopDate');
	}
	function pdcxAbtn() {
		window.location.href="property/localSearch.html";
		// checkNetwork("property/localSearch.html");

	}

	function sjxzAbtn() {
		checkNetwork("property/downloadList.html");
	}

	function bdxzcxAbtn() {
		window.location.href="property/propertySearch.html";
		// checkNetwork("property/propertySearch.html");

	}

	function sjscAbtn() {
		checkNetwork("property/uploadData.html");
	}

	function bfsqAbtn() {
		checkNetwork("destory/destory.html");
	}
	function bfspAbtn() {
		checkNetwork("destory/shenpiList.html");
	}

	function bfcxAbtn() {
		checkNetwork("destory/desSearch.html");
	}
	function dbsqAbtn() {
		checkNetwork("transfer/transferEnter.html");
	}

	function dbczAbtn() {
		checkNetwork("transfer/transferList.html");
	}

	function dbspAbtn() {
		checkNetwork("transfer/shenpi.html");
	}
	function dcqrAbtn() {
		checkNetwork("transfer/transferOUT.html");
	}
	function drqrAbtn() {
		checkNetwork("transfer/transferIN.html");
	}
	function dbcxAbtn() {
		checkNetwork("transfer/DBsearch.html");
	}
	function zccxAbtn() {
		checkNetwork("search/zcSearch.html");
	}
	function tzcxAbtn() {
		checkNetwork("search/tzSearch.html");
	}
	function hzcxAbtn() {
		checkNetwork("search/hzSearch.html");
	}

	function fwqszAbtn() {
		checkNetwork("set/server.html");
	}

	function xgmmAbtn() {
		checkNetwork("set/reset.html");
	}

	function qhdwAbtn() {
		checkNetwork("unit.html");
	}

	function cxdlAbtn() {
		checkNetwork("login.html");
	}

	function zcpdLinkViewShow() {
		$(".linkView2").hide();
		$("#zcpdLinkView").show();
		$("#indexGoBack").show();

	}

	function bfglLinkViewShow() {
		$(".linkView2").hide();
		$("#bfglLinkView").show();
		$("#indexGoBack").show();
	}

	function dbglLinkViewShow() {
		$(".linkView2").hide();
		$("#dbglLinkView").show();
		$("#indexGoBack").show();
	}

	function tjcxLinkViewShow() {
		$(".linkView2").hide();
		$("#tjcxLinkView").show();
		$("#indexGoBack").show();
	}

	function jyzglLinkViewShow() {
		$(".linkView2").hide();
		$("#jyzglLinkView").show();
		$("#indexGoBack").show();
	}

	function indexGoBack() {
		$("#indexGoBack").hide();
		$("#tjcxLinkView").hide();
		$("#dbglLinkView").hide();
		$("#bfglLinkView").hide();
		$("#zcpdLinkView").hide();
		$("#jyzglLinkView").hide();

		$(".linkView2").show();
	}

	function deletePDImgs() {
		zcpdImgs = [];
		$("#zcpdImgsDiv").html("");
	}

	function deletePYImgs() {
		zcpdImgs = [];
		$("#pyImgsDiv").html("");
	}

	function zjblrAbtn() {
		pyFrom = 0;
		zcpdImgs = [];
		$(".navCon").html("周检表录入");
		$("#pyImgsDiv").html("");
		$("#Hbox1").addClass("active");
		$("#Hbox2").addClass("active");
		$(".scrollCon1").hide(); 
		$(".scrollCon2").hide();
		$(".scrollCon3").show();

		$(".pdBottom").hide();
		$(".yzglBottom").show();
		var zjbData = localStorage.getItem("zjbDataStorage");
		zjbData = JSON.parse(zjbData);
		
		$.each(zjbData,function(name,value) {
			$("#" + name).val(value);
			if (value) {
				$("#" + name).show();
			}
		});
	};

	function zjbscAbtn() {
		checkNetwork("property/zjbUpload.html");
	}




	function checkNetwork(url) {
		if (window.JsCallback) {
			//判断是否开启了飞行模式
			if (window.JsCallback.onGetIsAirplaneMode()) {
				alert("请检查网络");
				return false;
			}else {
				
			}
		} else {
			if (window.navigator.onLine == true) {
				
			} else {
				alert("请检查网络");
				return false;
			}
		}
		window.location.href=url;
	}

	$("#pyDepartCode").bind("select propertychange change",function(event){
        // var departList = $.cookie('departList');
		var departList = localStorage.getItem('departList');

		departList = JSON.parse(departList);
		$.each(departList,function(){
			var that = this;   
			if(that.departcode == $("#pyDepartCode").val()) {
				$("#pyManagerDepart").val(that.departname);
				return;
			}
		})
        
    });


	if (window.JsCallback) {
        //安卓            
        callbackGetServerConfig(window.JsCallback.onGetServerConfig());
    } else {
        //IOS 
        setupWebViewJavascriptBridge(function (bridge) {
            bridge.callHandler('getCurrentServerConfig', callbackGetServerConfig)
        })
    }
	function callbackGetServerConfig(result) { 
        // if (result!= null&&result!= "") {  
		// 	var urlResultJson = JSON.parse(result);    
        //     var pUrl =  urlResultJson.server1+"://" + urlResultJson.server2 + ":" + urlResultJson.server3;
		// 	$.cookie('postUrl', pUrl, { expires: 7, path: '/', secure: false });
        // }
	}
	
	function dbFunction() {
		if (window.JsCallback) {
			//判断是否开启了飞行模式
			if (window.JsCallback.onGetIsAirplaneMode()) {
				alert("请检查网络");
				return false;
			}else {
				
			}
		} else {
			if (window.navigator.onLine == true) {
				
			} else {
				alert("请检查网络");
				return false;
			}
		}

		var countUrl = getURL() + '/mobile/toDoController.do?tododetailcounts';
		var countReqJson = {
			userCode: userInfo.usercode,
			departCode: userInfo.departcode 
		}
		sendPostAsync(countUrl, countReqJson, countResfunc)
	}

	
	function countResfunc(data) {
		if (window.JsCallback) {
			window.JsCallback.onHideProgress()
		}else{
			setupWebViewJavascriptBridge(function (bridge) {
				bridge.callHandler('onHideProgress') 
			})
		}
        if (data.success == 'true') {
			searchWpCount({'checkResult':null,'departCode':$("#pyDepartCode").val()})	
			if ( localStorage.getItem("pdjhCount")) {
				var wpjhCount = data.data[0].PDJH - 1;
				if (wpjhCount <0) {
					wpjhCount = 0;
				}
				$("#wpjhCount").html(wpjhCount)
			} else {
				$("#wpjhCount").html(data.data[0].PDJH)
			}
			
			// $("#dbsbCount").html(data.data[0].ZCDB)
			$("#dbspCount").html(data.data[0].ZCDB)
			$("#drqrCount").html(data.data[0].ZCDR)
			$("#dcqrCount").html(data.data[0].ZCDC)
			$("#bfspCount").html(data.data[0].ZCBF)
		}
	}

	function searchWpCount(term){
        var require = JSON.stringify(term);//这个是JSON字符串参数 
        if (window.JsCallback) {
            var res = window.JsCallback.onFindDevicesByDepartCode(require);
            templateWpCount(res,term)
        }else{
            setupWebViewJavascriptBridge(function (bridge) {
                    bridge.callHandler('onFindDevicesByDepartCode',require, function(resData){
                        templateWpCount(resData, term)
                    })
                }) 
        }
       
    }
function templateWpCount(res, term){
    var arr={};
    arr.data=JSON.parse(res);
    if(term.checkResult == null) {
		$("#zzpdCount").html(arr.data.length)
    }
} 

window.onload=function (){

dbFunction();




}
// $(function(){
    
//     dbFunction();
    
// });

	
</script>

<script>

	var swiper = new Swiper('.swiper-container', {
		initialSlide :0,
		observer:true,//修改swiper自己或子元素时，自动初始化swiper
		observeParents:true//修改swiper的父元素时，自动初始化swiper
	});
</script>
</html>